<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sovereign Settlement | GSU Mathification</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: #0f172a; color: #e2e8f0; line-height: 1.6; }
        .nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: rgba(0, 0, 0, 0.5); border-bottom: 1px solid rgba(59, 130, 246, 0.3); }
        .logo { font-weight: 700; color: #3b82f6; letter-spacing: 1px; text-transform: uppercase; }
        .wrap { max-width: 800px; margin: 0 auto; padding: 20px; }
        
        /* Dashboard Stats */
        .dash { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 30px; }
        .stat-box { background: rgba(59, 130, 246, 0.05); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px; padding: 15px; text-align: center; transition: all 0.3s ease; }
        .stat-label { font-size: 12px; text-transform: uppercase; color: #94a3b8; letter-spacing: 1px; }
        .stat-val { font-size: 28px; font-weight: 800; color: #fff; font-variant-numeric: tabular-nums; }
        .pop { color: #fbbf24; }
        .food { color: #4ade80; }
        .treasury { color: #38bdf8; }
        .danger { background: rgba(248, 113, 113, 0.1); border-color: #f87171; color: #f87171 !important; }
        
        /* Game Area */
        .scene-card { background: #1e293b; border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 30px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border-top: 3px solid #3b82f6; }
        .scene-title { font-size: 24px; color: #3b82f6; margin-bottom: 15px; border-bottom: 1px solid rgba(59, 130, 246, 0.2); padding-bottom: 10px; }
        .scene-desc { font-size: 18px; margin-bottom: 25px; }
        
        /* Choices */
        .choice-btn { display: block; width: 100%; text-align: left; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.2); color: #fff; padding: 16px 20px; margin-bottom: 12px; border-radius: 8px; font-size: 16px; cursor: pointer; transition: all 0.2s ease; }
        .choice-btn:hover { background: rgba(59, 130, 246, 0.15); border-color: #3b82f6; transform: translateX(5px); }
        
        /* GENO Feedback Area */
        .feedback-area { display: none; background: rgba(56, 189, 248, 0.1); border-left: 4px solid #38bdf8; padding: 20px; border-radius: 0 8px 8px 0; margin-top: 20px; }
        .feedback-title { font-weight: 700; color: #38bdf8; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .next-btn { background: #3b82f6; color: #fff; border: none; padding: 12px 24px; font-size: 16px; font-weight: 700; border-radius: 6px; cursor: pointer; margin-top: 20px; text-transform: uppercase; letter-spacing: 1px; }
        .next-btn:hover { background: #2563eb; }
        
        @media (max-width: 600px) { .dash { grid-template-columns: 1fr; gap: 10px; } }
    </style>
</head>
<body>

<div class="nav">
    <div class="logo">GSU Mathification</div>
    <div style="font-size: 14px; color: #94a3b8;">Level 2: Sovereign Settlement</div>
</div>

<div class="wrap">
    <div class="dash">
        <div class="stat-box" id="box-pop">
            <div class="stat-label">Population</div>
            <div class="stat-val pop" id="v-pop">50</div>
        </div>
        <div class="stat-box" id="box-food">
            <div class="stat-label">Food Stores (Days)</div>
            <div class="stat-val food" id="v-food">120</div>
        </div>
        <div class="stat-box" id="box-treasury">
            <div class="stat-label">Treasury</div>
            <div class="stat-val treasury" id="v-treasury">$500</div>
        </div>
    </div>

    <div class="scene-card" id="game-card">
        <h2 class="scene-title" id="s-title">The Governor's Ledger</h2>
        <div class="scene-desc" id="s-desc">
            You are the governor of a newly established settlement. You have 50 citizens relying on you. Winter is approaching. If you guess the math, the settlement starves. If you calculate correctly, your town thrives. GENO, your official settlement advisor, is standing by to audit your ledger.
        </div>
        
        <div id="choices-area">
            <button class="choice-btn" onclick="startGame()">Open the Ledger (Start)</button>
        </div>

        <div class="feedback-area" id="feedback-area">
            <div class="feedback-title">ü§ñ G.E.N.O. Says:</div>
            <div id="f-text"></div>
            <button class="next-btn" onclick="nextTask()">Next Month ‚ûî</button>
        </div>
    </div>
</div>

<script>
    let state = { pop: 50, food: 120, treasury: 500, task: 0 };

    const tasks = [
        {
            title: "Month 1: Land Allocation (Fractions & Percentages)",
            desc: "The settlement has been granted exactly 100 acres of land. You must designate 25% of the land for housing. Of the remaining land, exactly 1/2 must be used to plant wheat. How many acres are left over for grazing cattle?",
            choices: [
                {
                    text: "25 acres",
                    popEffect: 0, foodEffect: -30, treasEffect: 0,
                    feedback: "Incorrect calculation. 100 acres minus 25% (25 acres) leaves 75 acres. Half of 75 is 37.5, not 50. Because you miscalculated, the cattle did not have enough grazing land, and we lost 30 days of food stores."
                },
                {
                    text: "37.5 acres",
                    popEffect: +5, foodEffect: 0, treasEffect: 0,
                    feedback: "Perfect logic! 100 total acres minus 25 (for housing) leaves 75 acres. Half of 75 is 37.5 for wheat, leaving exactly 37.5 acres for the cattle. Your precise planning attracted 5 new settlers!"
                },
                {
                    text: "50 acres",
                    popEffect: 0, foodEffect: -40, treasEffect: 0,
                    feedback: "A catastrophic error. You forgot to subtract the housing land first. 1/2 of 100 is 50, but we only had 75 acres available. You promised land to the farmers that did not exist. Morale dropped and we lost food stores."
                }
            ]
        },
        {
            title: "Month 2: Winter Rationing (Division)",
            desc: "Winter will last exactly 120 days. You have successfully harvested 4,800 pounds of grain. You have 50 people in your settlement. If you divide it equally, how many pounds of grain does each person get PER DAY?",
            choices: [
                {
                    text: "1.2 pounds per day",
                    popEffect: -10, foodEffect: -20, treasEffect: 0,
                    feedback: "Wrong. You divided 4800 by 120 to get 40, but then you divided by the wrong number. The correct math is: 4800 total pounds divided by 50 people equals 96 pounds per person. 96 pounds divided by 120 days equals 0.8 pounds. You over-rationed, and 10 people starved."
                },
                {
                    text: "0.8 pounds per day",
                    popEffect: 0, foodEffect: +20, treasEffect: 0,
                    feedback: "Outstanding. 4,800 total pounds divided by 50 people equals 96 pounds per person for the winter. 96 divided by 120 days equals exactly 0.8 pounds per day. You secured the food supply!"
                },
                {
                    text: "9.6 pounds per day",
                    popEffect: -15, foodEffect: -50, treasEffect: 0,
                    feedback: "A deadly mistake. You moved the decimal point. You told the citizens they could eat almost 10 pounds of food a day. The stores ran out in two weeks. 15 people left the settlement."
                }
            ]
        },
        {
            title: "Month 3: The Trading Post (Economics)",
            desc: "A traveling merchant arrives before the snow hits. He is selling thick winter coats for the entire population. He wants $200 total. However, he offers you a 15% discount if you pay him in silver today. What is the final cost?",
            choices: [
                {
                    text: "$170",
                    popEffect: 0, foodEffect: 0, treasEffect: -170,
                    feedback: "Exactly right. 15% of $200 is $30. $200 minus $30 is $170. You kept your people warm and saved the treasury $30 by understanding basic financial percentages."
                },
                {
                    text: "$185",
                    popEffect: 0, foodEffect: 0, treasEffect: -200,
                    feedback: "Incorrect. You simply subtracted 15 from 200, rather than calculating 15 PERCENT of 200. The merchant overcharged you. You paid the full $200 out of the treasury."
                },
                {
                    text: "$30",
                    popEffect: 0, foodEffect: 0, treasEffect: -200,
                    feedback: "A terrible error. You calculated the discount ($30), but you thought that was the final price. When you handed him $30, the merchant was insulted and charged you full price. You lost $200."
                }
            ]
        },
        {
            title: "Month 4: The Seed Reserve (Ratios)",
            desc: "Spring is almost here. You have 1,500 bushels of wheat left over. You must save 20% of this wheat to use as seeds for next year's crop, or the town will die. How many bushels are you allowed to sell to the neighboring town?",
            choices: [
                {
                    text: "300 bushels",
                    popEffect: 0, foodEffect: -20, treasEffect: +100,
                    feedback: "You sold the wrong pile! 20% of 1,500 is 300. That is the amount you were supposed to KEEP for seed. Instead, you sold it and kept 1,200. The neighboring town feels cheated, and your farmers are confused."
                },
                {
                    text: "1,200 bushels",
                    popEffect: +10, foodEffect: 0, treasEffect: +200,
                    feedback: "A masterclass in civilization building! 20% of 1,500 is 300 bushels. You kept the 300 for seed, and successfully sold the remaining 1,200 bushels to the neighbor, adding $200 to your treasury and attracting 10 new citizens!"
                },
                {
                    text: "1,500 bushels",
                    popEffect: -20, foodEffect: -50, treasEffect: +300,
                    feedback: "You sold everything! You made money, but you doomed the settlement. With no seeds left for next year, the farmers have nothing to plant. The population is abandoning the town."
                }
            ]
        }
    ];

    function updateDash() {
        document.getElementById('v-pop').textContent = state.pop;
        document.getElementById('v-food').textContent = state.food;
        document.getElementById('v-treasury').textContent = "$" + state.treasury;
        
        let popBox = document.getElementById('box-pop');
        if (state.pop < 30) popBox.classList.add('danger');
        else popBox.classList.remove('danger');
        
        let foodBox = document.getElementById('box-food');
        if (state.food < 50) foodBox.classList.add('danger');
        else foodBox.classList.remove('danger');
        
        let treasBox = document.getElementById('box-treasury');
        if (state.treasury < 100) treasBox.classList.add('danger');
        else treasBox.classList.remove('danger');
    }

    function speak(text) {
        if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel();
            let msg = new SpeechSynthesisUtterance(text);
            window.speechSynthesis.speak(msg);
        }
    }

    function startGame() {
        state.pop = 50;
        state.food = 120;
        state.treasury = 500;
        state.task = 0;
        updateDash();
        loadTask();
    }

    function loadTask() {
        if (state.pop <= 0 || state.food <= 0 || state.treasury < 0) {
            gameOver("Your mathematical errors led to the collapse of the settlement. In the real world, grammar and logic are the difference between life and death. You have been removed as governor.");
            return;
        }

        if (state.task >= tasks.length) {
            gameWin();
            return;
        }

        let task = tasks[state.task];
        document.getElementById('s-title').textContent = task.title;
        document.getElementById('s-desc').textContent = task.desc;
        
        let choicesHTML = "";
        task.choices.forEach((choice, idx) => {
            choicesHTML += `<button class="choice-btn" onclick="makeChoice(${idx})">${choice.text}</button>`;
        });
        
        document.getElementById('choices-area').innerHTML = choicesHTML;
        document.getElementById('choices-area').style.display = "block";
        document.getElementById('feedback-area').style.display = "none";
    }

    function makeChoice(idx) {
        let choice = tasks[state.task].choices[idx];
        
        state.pop += choice.popEffect;
        state.food += choice.foodEffect;
        state.treasury += choice.treasEffect;
        updateDash();

        document.getElementById('choices-area').style.display = "none";
        document.getElementById('f-text').innerHTML = `<strong>${choice.feedback}</strong>`;
        document.getElementById('feedback-area').style.display = "block";
        
        speak(choice.feedback);
    }

    function nextTask() {
        state.task++;
        loadTask();
    }

    function gameOver(reason) {
        document.getElementById('s-title').textContent = "üõë SETTLEMENT COLLAPSE";
        document.getElementById('s-title').style.color = "#f87171";
        document.getElementById('s-desc').textContent = reason;
        document.getElementById('choices-area').innerHTML = `<button class="choice-btn" style="text-align:center" onclick="startGame()">Start a New Settlement</button>`;
        document.getElementById('choices-area').style.display = "block";
        document.getElementById('feedback-area').style.display = "none";
        speak("The settlement has collapsed. Try again, and measure carefully.");
    }

    function gameWin() {
        document.getElementById('s-title').textContent = "üèÜ SOVEREIGN CIVILIZATION";
        document.getElementById('s-title').style.color = "#4ade80";
        
        let finalStatus = `You survived the first year! Your settlement has grown to ${state.pop} citizens, you have ${state.food} days of food in reserve, and your treasury sits at $${state.treasury}. You proved that math is not just for exams‚Äîit is the blueprint for civilization!`;

        document.getElementById('s-desc').textContent = finalStatus;
        document.getElementById('choices-area').innerHTML = `<button class="choice-btn" style="text-align:center" onclick="startGame()">Play Again</button>`;
        document.getElementById('choices-area').style.display = "block";
        document.getElementById('feedback-area').style.display = "none";
        speak("Congratulations! " + finalStatus);
    }
</script>

</body>
</html>